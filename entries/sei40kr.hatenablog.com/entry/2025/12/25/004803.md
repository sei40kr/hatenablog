---
Title: 生成AIはなぜ幻覚（hallucination）を見るのか
Date: 2025-12-25T00:48:03+09:00
URL: https://sei40kr.hatenablog.com/entry/2025/12/25/004803
EditURL: https://blog.hatena.ne.jp/sei40kr/sei40kr.hatenablog.com/atom/entry/17179246901336342233
---

LLM（大規模言語モデル）をはじめとする現代の生成AIが、事実に基づかない情報を生成する現象は**hallucination（幻覚）**と呼ばれる。この現象は、機械学習の根幹をなす「関数近似」という性質に深く根ざしている。

# 訓練データという制約と関数近似

機械学習の基礎は、与えられた訓練データを「制約」と見なし、それらを高い精度で再現できる関数 [tex: f] を見つけ出すことにある。

例えば、[tex: f(a) = s, f(b) = t, f(c) = u] という制約を満たす関数を求めたいとする。このような条件を満たす数式を構成する手法の一つに**ラグランジュ補間**がある。

<div style="text-align: center">
[tex: \displaystyle
f(x) = \frac{(x-b)(x-c)}{(a-b)(a-c)}s + \frac{(x-a)(x-c)}{(b-a)(b-c)}t + \frac{(x-a)(x-b)}{(c-a)(c-b)}u
]
</div>

この数式は [tex: x=a] のときに [tex: f(a)=s] となるよう設計されている。現代の**ニューラルネットワーク（NN）**も、手法こそ異なるが「複数の制約（訓練データ）に適合する関数を近似していく」という点ではこのアプローチの延長線上にある。NNという巨大な関数近似器を、反復的な学習プロセスを通じて最適化していくのが現代のAIの礎である。

## 推論プロセスにおける補完とハルシネーション

AIが未知の入力 [tex: d] に対して回答を生成する際、推論器はデータベースから特定の回答を検索しているのではない。構築された近似関数 [tex: f] に [tex: d] を入力し、得られた演算結果 [tex: f(d)] を出力している。

ここで [tex: d] は訓練データに存在しない値であるため、必然的に**補完**された値となる。

* **汎用性**: 補完された [tex: f(d)] が、現実の論理や文脈に即している場合。これはAIの優れた推論能力として評価される。
* **幻覚（hallucination）**: 近似関数が訓練データの制約を満たしていても、未知の入力 [tex: d] に対して誤った値を返してしまう場合。

つまり、hallucinationとは「関数近似という仕組みが、未知の領域を埋めようとして生じさせた不適切な補完誤差」である。

## データの特性による近似の困難さ

関数近似という手法は、扱うデータの背景にある構造によってその安定性が大きく左右される。特に数値や確定事実のようなデータは、言語パターンに比べて補完が極めて難しい。

| 比較項目 | 自然言語のパターン | 数値・確定事実 |
| --- | --- | --- |
| **背景の構造** | 分布仮説に基づき、文脈から類推が可能 | 物理法則や社会情勢など複雑な背景を持つ |
| **外乱の影響** | 文脈により多少のノイズは許容される | 突発的イベント等により急激かつ不連続に変動する |
| **近似の性質** | 確率的な「尤もらしさ」で補完しやすい | 厳密な正解（点）を外すと即座にhallucinationとなる |
| **知識の鮮度** | 言語構造の寿命は長い | **学習カットオフ以降の最新情報に対応できない** |

自然言語は「似た文脈には似た単語が現れる」という分布仮説に従うため近似しやすい。一方で、数値データなどは背景にある複雑な要因や突発的なノイズを抱えており、関数近似の「隙間を埋める」という性質と非常に相性が悪い。学習データを収集した時点までの限定的な知識に基づき、無理に関数として補完しようとした結果、尤もらしい誤情報が生成されるのである。

# 結論

AIがhallucinationを起こすのは、それが情報を「検索」しているのではなく、情報を「関数として近似」しているからである。

離散的な訓練データの隙間を連続的な関数で埋めるという設計思想は、AIに高い汎用性を与える一方で、構造的に誤情報を生成するリスクを内包している。hallucinationは、関数近似という強力な手法が持つ避けられない副作用なのである。
